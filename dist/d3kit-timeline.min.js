!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("d3-array"),require("d3-axis"),require("d3-scale"),require("d3kit"),require("labella")):"function"==typeof define&&define.amd?define(["d3-array","d3-axis","d3-scale","d3kit","labella"],t):"object"==typeof exports?exports.d3KitTimeline=t(require("d3-array"),require("d3-axis"),require("d3-scale"),require("d3kit"),require("labella")):e.d3KitTimeline=t(e.d3,e.d3,e.d3,e.d3Kit,e.labella)}(this,function(e,t,i,o,n){return function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),l=(i.n(a),i(3)),s=(i.n(l),i(1)),u=(i.n(s),i(4)),c=(i.n(u),i(5)),d=i.n(c),f=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),p=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,o)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(o)},h=function(e){return e},b=function(e){function t(e,r){o(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return l.layers.create(["dummy",{main:["axis","link","label","dot"]}]),l.layers.get("main.axis").classed("axis",!0),l.axis=i.i(a.axisLeft)(),l.visualize=l.visualize.bind(l),l.on("data",l.visualize),l.on("options",l.visualize),l.on("resize",l.visualize),l}return r(t,e),f(t,null,[{key:"getDefaultOptions",value:function(){return u.helper.deepExtend(p(t.__proto__||Object.getPrototypeOf(t),"getDefaultOptions",this).call(this),{margin:{left:40,right:20,top:20,bottom:20},initialWidth:400,initialHeight:400,scale:i.i(l.scaleTime)(),domain:void 0,direction:"right",dotRadius:3,layerGap:60,labella:{},keyFn:void 0,timeFn:function(e){return e.time},textFn:function(e){return e.text},dotColor:"#222",labelBgColor:"#222",labelTextColor:"#fff",linkColor:"#222",labelPadding:{left:4,right:4,top:3,bottom:2},textYOffset:"0.85em"})}},{key:"getCustomEventNames",value:function(){return["dotClick","dotMouseover","dotMousemove","dotMouseout","labelClick","labelMouseover","labelMousemove","labelMouseenter","labelMouseleave","labelMouseout"]}}]),f(t,[{key:"resizeToFit",value:function(){var e=this.options(),t=void 0;switch(e.direction){case"up":t=t(force.nodes(),function(e){return Math.abs(e.y)})||0,this.height(t+e.margin.top+e.margin.bottom);break;case"down":t=t(force.nodes(),function(e){return Math.abs(e.y+e.dy)})||0,this.height(t+e.margin.top+e.margin.bottom);break;case"left":t=t(force.nodes(),function(e){return Math.abs(e.x)})||0,this.width(t+e.margin.left+e.margin.right);break;case"right":t=t(force.nodes(),function(e){return Math.abs(e.x+e.dx)})||0,this.width(t+e.margin.left+e.margin.right)}return this}},{key:"updateLabelText",value:function(e,t,i){var o=this.options();return i=i?u.helper.functor(i):h,e.text(function(e){return o.textFn(i(e))}).attr("dy",o.textYOffset).attr("x",o.labelPadding.left).attr("y",o.labelPadding.top),Object.keys(t).forEach(function(o){var n=t[o];e.style(o,function(e,t){return n(i(e),t)})}),e}},{key:"drawScale",value:function(){var e=this.options(),t=void 0;switch(e.direction){case"right":this.axis=i.i(a.axisLeft)(),t="translate(0,0)";break;case"left":this.axis=i.i(a.axisRight)(),t="translate("+this.getInnerWidth()+",0)";break;case"up":this.axis=i.i(a.axisBottom)(),t="translate(0,"+this.getInnerHeight()+")";break;case"down":this.axis=i.i(a.axisTop)(),t="translate(0,0)"}return this.axis.scale(e.scale),layers.get("main").attr("transform",t),layers.get("main.axis").call(this.axis),this}},{key:"timePos",value:function(e){var t=this.options();return t.scale(t.timeFn(e))}},{key:"drawDots",value:function(e){var t=layers.get("main.dot").selectAll("circle.dot").data(e,options.keyFn),i="left"===options.direction||"right"===options.direction?"cy":"cx";t.enter().append("circle").classed("dot",!0).on("click",function(e,t){dispatch.dotClick(e,t)}).on("mouseover",function(e,t){dispatch.dotMouseover(e,t)}).on("mousemove",function(e,t){dispatch.dotMousemove(e,t)}).on("mouseout",function(e,t){dispatch.dotMouseout(e,t)}).style("fill",options.dotColor).attr("r",options.dotRadius).attr(i,timePos),t.transition().style("fill",options.dotColor).attr("r",options.dotRadius).attr(i,timePos),t.exit().remove()}},{key:"visualize",value:function(){if(this.hasData()&&this.hasNonZeroArea()){var e=this.data()||[],t=this.options();new d.a.Force(t.labella);t.domain?t.scale.domain(t.domain):t.scale.domain(i.i(s.extent)(e,t.timeFn)).nice(),t.scale.range([0,"left"===t.direction||"right"===t.direction?this.getInnerHeight():this.getInnerWidth()]),this.drawScale(),this.drawDots(e);var o=d3Kit.helper.extend({},t.textStyle);Object.keys(o).forEach(function(e){o[e]=u.helper.functor(o[e])}),o.fill=o.fill||u.helper.functor(t.labelTextColor);var n=layers.get("dummy").append("text").classed("label-text",!0),r=e.map(function(e){var i=n.call(updateLabelText,o,e)[0][0].getBBox(),r=i.width+t.labelPadding.left+t.labelPadding.right,a=i.height+t.labelPadding.top+t.labelPadding.bottom,l=new d.a.Node(timePos(e),"left"===t.direction||"right"===t.direction?a:r,e);return l.w=r,l.h=a,l});return n.remove(),force.options(t.labella).nodes(r).compute(),drawLabels(force.nodes(),o),this}}}]),t}(u.SvgChart);t.default=b},function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t){e.exports=n},function(e,t,i){e.exports=i(0)}])});